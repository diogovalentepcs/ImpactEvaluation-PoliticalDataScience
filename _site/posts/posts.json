[
  {
    "path": "posts/2022-12-03-2022-12-01-proyecto-p4-modelo/",
    "title": "[Proyecto | Modelo] Creación del Modelo y Resultados",
    "description": "En esta publicación se crea el modelo de impacto causal y se analizan los resultados.",
    "author": [
      {
        "name": "Diogo Polónia",
        "url": "https://diogovalentepcs.github.io/website/"
      }
    ],
    "date": "2022-12-03",
    "categories": [],
    "contents": "\n\n\nlibrary(stringr)  # adding variable sto a string\nlibrary(dplyr)    # manipulate dataframes\nlibrary(tidyr)    # tidying data\nlibrary(naniar)   # missing data visualizations\nlibrary(ggplot2)  # graphs\nlibrary(ggbreak)\nlibrary(texreg)\n\n\n\n\nlong_data <- read.csv(str_glue('{params$datapath}clean_long_data.csv'), header = TRUE, sep = ',')\n\nlong_data[1:10,]\n\n   DateYYMMDD Year Month Day Hour       Station   CO     Hum  SO2\n1      180201   18     2   1    0    CerroNavia 0.21 43.7500   NA\n2      180201   18     2   1    0      ElBosque 0.38 52.0050 1.00\n3      180201   18     2   1    0 Independencia 0.10 40.1718   NA\n4      180201   18     2   1    0     LasCondes 0.30 51.5833   NA\n5      180201   18     2   1    0      OHiggins 0.28 48.0883   NA\n6      180201   18     2   1    0    PuenteAlto 0.14 49.8384 3.32\n7      180201   18     2   1    0     Talagante 0.10 71.1770 1.00\n8      180201   18     2   1    1    CerroNavia 0.22 45.9167   NA\n9      180201   18     2   1    1      ElBosque 0.26 52.0043 1.00\n10     180201   18     2   1    1 Independencia 0.11 42.4210   NA\n      Temp WindSpeed\n1  18.6083  0.462993\n2  18.6942  0.544481\n3  22.1442  0.333802\n4  19.2417  1.931830\n5  18.8942  0.134353\n6  18.8442  0.898380\n7  12.8513  0.181700\n8  17.5417  0.447070\n9  18.1688  0.556726\n10 21.3438  0.445399\n\nHoras de Punta\n\n\nlong_data %>%\n  group_by(Hour) %>%\n  summarise(CO = mean(CO)) %>%\n  ggplot(aes(x=as.factor(Hour), y=CO, color=as.factor(Hour))) + \n  geom_point(size = 3) + \n  labs(x = \"Hour\", y = \"CO\", title = \"Concentraciones de CO en Santiago\") +\n  theme(legend.position= \"none\")\n\n\n\nLas horas punta se definen como las dos horas consecutivas que marcan\nde media las lecturas más altas en los dos años de la muestra.\nGraficamente se puede observar que estas horas son de 7-9 am.\nContaminación de Fundo\nPara el valor de contaminación de fundo consideramos el promedio de 4\nregistros consecutivos de CO que, en promedio, mostraron la menor\ndispersión a lo largo de la muestra: 3–7 am\n\n\nlong_data %>%\n  group_by(Hour) %>%\n  summarise(CO = sd(CO)) %>%\n  ggplot(aes(x=as.factor(Hour), y=CO, color=as.factor(Hour))) + \n  geom_point(size = 3) + \n  labs(x = \"Hour\", y = \"CO\", title = \"Desvios Standard de CO en Santiago\") +\n  theme(legend.position= \"none\")\n\n\n\nDataset Final\n\n\ndf <- long_data[long_data$Hour >= 3 & long_data$Hour < 9,]\n\ndf %>%\n  subset(Hour >= 7 & Hour < 9) %>%\n  group_by(DateYYMMDD) %>%\n  summarise(CO = mean(CO)) %>%\n  ggplot(aes(x=factor(DateYYMMDD), y=CO)) + \n  geom_point(size = 3, color = \"lightblue\") + \n  geom_vline(xintercept = as.factor(190201), linetype = \"dotted\", color = \"sienna\", size=1) +\n  annotate(\"text\", x= as.factor(190115), y=1.5, label=\"Implementación de Política\", angle=90, size=3.5) + \n  labs(x = \"Date\", y = \"CO\", title = \"Registros diarios de CO durante las horas punta\") +\n  scale_x_discrete( breaks = as.factor(c(180201, 190201, 200131))) +\n  theme(legend.position= \"none\")\n\n\n\nUnión con la distancia\na las bicicletas\nLos datos sobre la ubicación de las estaciones de bicicletas y el\nnúmero de plazas se recuperaron manualmente a través de Google Maps, y\nse creó un excel con información sobre 119 estaciones (2 de las cuales\nestán cerradas). La preparación posterior de los datos (por ejemplo, el\ncálculo de la distancia) se hizo en python. Es posible acceder al script\ncreado aquí.\nSe creó una variable por estación meteorológica (AverageBikeDistance)\nque es el promedio de las distancias desde la estación meteorológica a\ntodas las estaciones de bicicletas\n\n\nstations <- read.csv(str_glue('{params$datapath}weather_stations_info.csv'), header = TRUE, sep = ',')\ndf <- merge(x = df, y = stations[,c('Station', 'AverageBikeDistance')], all.x = TRUE, by= 'Station')\n\n\nCreación de todas\nlas variables del modelo\nEl modelo siegue esta regresión:\n\\[ y_{ts} = α_0 + α_1 \\cdot y_t^b + α_2\n\\cdot x_t + β_1 \\cdot T_t  +β_2 \\cdot T_t \\cdot d_s + \\sum δ_t \\cdot M_t\n+ ε_t \\]\ndonde \\(y_t\\) es la concentración de\nCO en el período (hora) t y en la estación meteorologica s, en logs. Las\nvariables explicativas son las siguientes:\n\\(y_t^b\\) es la contaminación de\nfondo antes de que se forme el pico, que corresponde a la contaminación\nnocturna (consideramos el promedio de 4 registros consecutivos de CO\nque, en promedio, mostraron la menor dispersión a lo largo de la\nmuestra: 3–7 am;\n\\(x_t\\) es un vector que incluye\nefectos fijos (hora del día, día de la semana y mes del año), medidas\nhorarias de variables meteorológicas como temperatura, humedad real,\nvelocidad del viento. También incluimos registros de SO2 como variable\nexplicativa, los cuales están fácilmente disponibles en las mismas\nestaciones de monitoreo.\nDado que el SO2 está principalmente relacionado con la actividad\nindustrial y la generación de energía, sirve como un control de\nfenómenos meteorológicos comunes a todos los contaminantes, pero que no\nson capturados en su totalidad por nuestras variables climáticas, como\nlas inversiones térmicas (Molina y Molina, 2002).\nEl efecto del sistema de Bike Itaú se captura con:\n\\(T_t\\), dummy que toma el valor de\n1 después de la implementación;\n\\(d_s\\), indica el promedio de las\ndistancias de la estación meteorologica s a las estaciones de bike\nitaú\n\\(M_t\\), un indicador de mes que\ncubre varios meses después de la implementación (hasta 12);\nEl efecto de la implementación de bicicletas compartidas sería \\(β + δ_1\\) a corto plazo (es decir, el\nprimer mes) y \\(β\\) a largo plazo.\nFinalmente, \\(ε_t\\) es el término de\nerror. Cada observación es una hora en que se detectó la concentración\nde CO.\nAsí que es necesario: 1. Que las observaciones (lineas) sean solo\nobservaciones de horas de punta, para todas las estaciones\nmeteorologicas 2. Crear la variable \\(y_t^b\\) (Background_CO) siendo el promedio\ncontaminacion para las horas 3-7 am para cada dia y estación meteorogica\n3. Organizar el vector \\(x_t\\) (hora\ndel día, día de la semana, mes del año, temperatura, humedad real,\nvelocidad del viento, y SO2) 4. Crear la variable de tratamiento \\(T_t\\), igual a 1 para todas las\nobservaciones posteriors al implementación 5. Creare Variable de\ninteracción \\(T_t \\cdot d_s\\) 6. Crear\nel vector \\(M_t\\), de variables dummy\npara cada mes después de la implementación\n\n\n# 1. Restrict observations\nmodel_df <- df[df$Hour >= 7 & df$Hour < 9,]\n\n# 2. Background Pollution\naux <- df[df$Hour >= 3 & df$Hour < 7,] %>%\n  group_by(DateYYMMDD) %>%\n  summarise(Background_CO = mean(CO))\nmodel_df <- merge(x = model_df, y = aux, all.x = TRUE, by = 'DateYYMMDD')\n\n# 3. Controls\n#Controls are all there (Month, Day, Hour, Hum, WindSpeed, Temp)\n\n# 4. Treatemnt Variable\nmodel_df$T <- ifelse(model_df$DateYYMMDD>=190201, 1, 0)\n\n# 5. Distance Interaction\nmodel_df$T_Dist <- model_df$T * model_df$AverageBikeDistance\n\n# 6. Monthly Binaries\nmodel_df$Month_1 <- ifelse(model_df$T==1 & model_df$Month==2, 1, 0)\nmodel_df$Month_2 <- ifelse(model_df$T==1 & model_df$Month==3, 1, 0)\nmodel_df$Month_3 <- ifelse(model_df$T==1 & model_df$Month==4, 1, 0)\nmodel_df$Month_4 <- ifelse(model_df$T==1 & model_df$Month==5, 1, 0)\nmodel_df$Month_5 <- ifelse(model_df$T==1 & model_df$Month==6, 1, 0)\nmodel_df$Month_6 <- ifelse(model_df$T==1 & model_df$Month==7, 1, 0)\nmodel_df$Month_7 <- ifelse(model_df$T==1 & model_df$Month==8, 1, 0)\nmodel_df$Month_8 <- ifelse(model_df$T==1 & model_df$Month==9, 1, 0)\nmodel_df$Month_9 <- ifelse(model_df$T==1 & model_df$Month==10, 1, 0)\nmodel_df$Month_10 <- ifelse(model_df$T==1 & model_df$Month==11, 1, 0)\nmodel_df$Month_11 <- ifelse(model_df$T==1 & model_df$Month==12, 1, 0)\nmodel_df$Month_12 <- ifelse(model_df$T==1 & model_df$Month==1, 1, 0)\n\nmodel_df[1:5,]\n\n  DateYYMMDD       Station Year Month Day Hour   CO     Hum SO2\n1     180201     Talagante   18     2   1    8 0.16 64.4167   1\n2     180201     LasCondes   18     2   1    7 0.49 48.9167  NA\n3     180201     Talagante   18     2   1    7 0.23 76.3333   1\n4     180201 Independencia   18     2   1    8 0.29 36.8333  NA\n5     180201      ElBosque   18     2   1    8 0.81 41.0139   1\n     Temp WindSpeed AverageBikeDistance Background_CO T T_Dist\n1 17.0333  0.804175           43.197227     0.3264286 0      0\n2 19.7750  1.680290            8.806011     0.3264286 0      0\n3 13.3750  0.320926           43.197227     0.3264286 0      0\n4 24.0833  0.563572            5.853655     0.3264286 0      0\n5 23.1819  0.911175           15.354876     0.3264286 0      0\n  Month_1 Month_2 Month_3 Month_4 Month_5 Month_6 Month_7 Month_8\n1       0       0       0       0       0       0       0       0\n2       0       0       0       0       0       0       0       0\n3       0       0       0       0       0       0       0       0\n4       0       0       0       0       0       0       0       0\n5       0       0       0       0       0       0       0       0\n  Month_9 Month_10 Month_11 Month_12\n1       0        0        0        0\n2       0        0        0        0\n3       0        0        0        0\n4       0        0        0        0\n5       0        0        0        0\n\nEjecución del Modelo\nEn primer lugar, analizaremos el impacto de la reestructuración de\nBike Itaú sin controlar los valores de SO2, ya que eso reduce el número\nde estaciones a analizar (sólo 4 estaciones tienen información fiable\nsobre el SO2). Veremos si el control de la distancia a las estaciones de\nbicicletas también afecta a la evaluación de forma significativa.\n\n\nregression_df <- model_df %>%\n  select(-c('DateYYMMDD', 'Station', 'AverageBikeDistance')) %>%\n  mutate(CO = log(CO))\n\n# Model 1 - not controlled by bicycle info neither SO2\nmodel_1 <- lm(CO ~ ., data = regression_df %>%\n                                select(-c('T_Dist', 'SO2')))\n\n# Model 2 - not controlled by SO2\nmodel_2 <- lm(CO ~ ., data = regression_df %>%\n                                select(-c('SO2')))\n\nmodels <- list(model_1, model_2)\n\nscreenreg(models)\n\n\n=========================================\n               Model 1       Model 2     \n-----------------------------------------\n(Intercept)        9.60 ***      8.89 ***\n                  (0.72)        (0.70)   \nYear              -0.49 ***     -0.47 ***\n                  (0.04)        (0.04)   \nMonth             -0.04 ***     -0.04 ***\n                  (0.00)        (0.00)   \nDay                0.00          0.00    \n                  (0.00)        (0.00)   \nHour               0.00          0.00    \n                  (0.01)        (0.01)   \nHum               -0.01 ***     -0.01 ***\n                  (0.00)        (0.00)   \nTemp              -0.05 ***     -0.04 ***\n                  (0.00)        (0.00)   \nWindSpeed         -0.32 ***     -0.29 ***\n                  (0.01)        (0.01)   \nBackground_CO      0.88 ***      0.92 ***\n                  (0.02)        (0.02)   \nT                  0.67 ***      0.92 ***\n                  (0.07)        (0.07)   \nMonth_1           -0.32 ***     -0.32 ***\n                  (0.06)        (0.06)   \nMonth_2           -0.18 **      -0.16 ** \n                  (0.05)        (0.05)   \nMonth_3           -0.13 *       -0.13 *  \n                  (0.05)        (0.05)   \nMonth_4           -0.24 ***     -0.23 ***\n                  (0.05)        (0.05)   \nMonth_5           -0.29 ***     -0.29 ***\n                  (0.05)        (0.05)   \nMonth_6           -0.18 ***     -0.19 ***\n                  (0.05)        (0.05)   \nMonth_7           -0.11 *       -0.10    \n                  (0.05)        (0.05)   \nMonth_8           -0.34 ***     -0.32 ***\n                  (0.05)        (0.05)   \nMonth_9           -0.31 ***     -0.28 ***\n                  (0.05)        (0.05)   \nMonth_10          -0.25 ***     -0.23 ***\n                  (0.06)        (0.05)   \nMonth_11          -0.17 **      -0.14 ** \n                  (0.06)        (0.05)   \nT_Dist                          -0.02 ***\n                                (0.00)   \n-----------------------------------------\nR^2                0.43          0.45    \nAdj. R^2           0.42          0.45    \nNum. obs.      10220         10220       \n=========================================\n*** p < 0.001; ** p < 0.01; * p < 0.05\n\nEl modelo 1 no controla las distancias a las estaciones, y el modelo\n2 sí. Lo primero que llama la atención es que, en contra de lo que sería\nel objetivo, la reestructuración parece aumentar la concentración de CO\nen las horas punta en un 67% (modelo 1) y un 92% (modelo 2), como\nobservable en el coeficiente de T, ambos significativos al 1%. Estos\nvalores son muy altos. Además, parece que el factor temporal tiene un\nimpacto bastante significativo, ya que tanto el año como el mes (después\nde la reestructuración) tienen coeficientes elevados. Lo más llamativo\nes que estos coeficientes son negativos, lo que demuestra que sin ningún\ncambio en el comportamiento de las personas, la concentración de CO\ndisminuiría de forma natural. Con estos resultados, se espera que haya\nuna gran influencia de factores externos no controlados, que se\nconfunden con el momento de la reestructuración.\nA continuación, controlamos el SO2 (eliminando las estaciones en las\nque no se registra el SO2):\n\n\n# Model 3 - not controlled by bicycle info (less observations)\nmodel_3 <- lm(CO ~ ., data = regression_df %>%\n                                select(-c('T_Dist')) %>% \n                                filter(!is.na('SO2')))\n\n# Model 4 - controlled by everything (less observations)\nmodel_4 <- lm(CO ~ ., data = regression_df %>% \n                                filter(!is.na('SO2')))\n\nmodels <- list(model_3, model_4)\n\nscreenreg(models)\n\n\n=======================================\n               Model 1      Model 2    \n---------------------------------------\n(Intercept)      12.11 ***    10.98 ***\n                 (1.09)       (1.08)   \nYear             -0.56 ***    -0.53 ***\n                 (0.06)       (0.06)   \nMonth            -0.04 ***    -0.04 ***\n                 (0.00)       (0.00)   \nDay               0.00         0.00    \n                 (0.00)       (0.00)   \nHour             -0.02        -0.01    \n                 (0.02)       (0.02)   \nHum              -0.02 ***    -0.02 ***\n                 (0.00)       (0.00)   \nSO2               0.14 ***     0.17 ***\n                 (0.01)       (0.01)   \nTemp             -0.09 ***    -0.08 ***\n                 (0.00)       (0.00)   \nWindSpeed        -0.26 ***    -0.25 ***\n                 (0.02)       (0.02)   \nBackground_CO     0.69 ***     0.75 ***\n                 (0.03)       (0.03)   \nT                 0.77 ***     1.10 ***\n                 (0.11)       (0.11)   \nMonth_1          -0.41 ***    -0.38 ***\n                 (0.09)       (0.09)   \nMonth_2          -0.36 ***    -0.30 ***\n                 (0.08)       (0.08)   \nMonth_3          -0.23 **     -0.20 *  \n                 (0.08)       (0.08)   \nMonth_4          -0.57 ***    -0.52 ***\n                 (0.08)       (0.08)   \nMonth_5          -0.45 ***    -0.42 ***\n                 (0.08)       (0.08)   \nMonth_6          -0.34 ***    -0.33 ***\n                 (0.08)       (0.08)   \nMonth_7          -0.36 ***    -0.30 ***\n                 (0.08)       (0.08)   \nMonth_8          -0.67 ***    -0.62 ***\n                 (0.08)       (0.08)   \nMonth_9          -0.70 ***    -0.63 ***\n                 (0.08)       (0.08)   \nMonth_10         -0.62 ***    -0.57 ***\n                 (0.08)       (0.08)   \nMonth_11         -0.55 ***    -0.51 ***\n                 (0.09)       (0.08)   \nT_Dist                        -0.01 ***\n                              (0.00)   \n---------------------------------------\nR^2               0.53         0.55    \nAdj. R^2          0.53         0.55    \nNum. obs.      4380         4380       \n=======================================\n*** p < 0.001; ** p < 0.01; * p < 0.05\n\nDe nuevo, el modelo 1 no controla las distancias a las estaciones, y\nel modelo 2 sí. La relevancia de controlar este gas es notable porque su\ncoeficiente es significativo al 1% y cambia (aumenta) el valor del\nefecto de la reestructuración (coeficiente de T), que siegue siendo\nsignificativo.\nDiscussión de Resultados\nComo se indicó anteriormente, los resultados implican que la\nreestructuración de Bike Itaú en realidad contribuyó al aumento de las\nconcentraciones de CO en horas de punta en Santiago. Además de eso,\nparece que las estaciones meteorológicas más distantes a las estaciones\nde bicicletas reportan concentraciones más bajas.\nAunque esto es muy probable debido a factores externos confundidos\ncon el tiempo de implementación y la ubicación de las estaciones de\nbicicletas, propongo dos razones de por qué se puede ver este\nefecto:\nLos viajes en bicicleta no están sustituyendo a los viajes en coche\nen horas de punta, sino que podrían estar sustituyendo el transporte\npúblico o los desplazamientos a pie, en momentods de ocio. Este\nrazonamiento es desarrollado más adelante por Ricci (2025).\nEl menor interés por el transporte público en horas de ocio, podría\ncontribuir a un mayor uso del coche en horas de punta. Las personas\npueden desanimarse a pagar costos fijos como la tarjeta bip o tener que\ncomprar viajes para el transporte público por horas de punta si sienten\nque no los usarán de todos modos en los momentos de ocio, porque ahora\ntienen Bike Itaú.\nEste trabajo tiene grandes limitaciones, siendo la principal la falta\nde un contrafactual confiable (Santiago sin la nueva estructura de Bike\nItaú, al mismo tiempo). Esto se ve mitigado por los controles empíricos\nagregados al modelo, pero también deberíamos estudiar un contrafactual.\nGallego et al. (2013) propone utilizar una pequeña ciudad de Chile como\ncontrafactual debido a sus tendencias similares de CO. Con eses datos\npodríamos construir un modelo de Diferencia en Diferencias que nos\npermitiría controlar los efectos de los factores externos.\nApesar de todo, este proceso empírico robusto y fuertemente apoyado\npor Gallego et al. (2013), permite ter confiança no sense do impact das\nvariáveis, e é possível afirmar, pelo menos, que o efeito de sistemas de\nbicicletas partilhadas não contribuem para a diminuição da utilização de\ncarros (em horas de ponta).\nObservaciones y Comentario\ndel Curso\nPara este curso, el objetivo era ser capaz de plantear un problema o\ncuestión de interés personal relacionado con un fenómeno político; y\nestablecer una hipótesis causal.\nPartiendo de una fuerte revisión teórica y literaria, se estudió el\nimpacto que tuvo la implementación, por parte de Muincípio y la empresa\nBike Itaú, del nuevo sistema de bicicletas compartidas para los\nresidentes y visitantes de Santiago, con planes mensuales de menos de 4\n000 pesos.\nLa hipótesis inicial era que el uso compartido de bicicletas tiene\nuna débil relación con la reducción del uso del auto. Los resultados\nfueron aún más sorprendentes al señalar una relación negativa entre la\nimplantación y el uso del auto (evaluado a través de la concentración de\nCO). Los resultados son significativos y pueden explicarse, por ejemplo,\npor el menor incentivo para utilizar el transporte público. Sin embargo,\nes probable que el modelo se vea afectado por factores externos no\ncontrolados.\nDurante el curso también se enseñaron diversas técnicas de análisis y\nmedición que, debido a la forma en que estaba planteado el problema, no\nera necesario (ni sería adecuado) ocupar (por ejemplo, variables\nlatentes, clustering, pca y analisis factorial).\nEstas técnicas podrían utilizarse en el futuro si se quisiera\nestudiar la heterogeneidad de los efectos calculados entre sectores\ndemográficos. Para ello, sería necesario cruzar los datos actuales con\nlos demográficos. Aun así, se considera que este trabajo ha logrado\nalcanzar los objetivos previstos e incluso puede contribuir a la\ninvestigación en este ámbito.\nGracias a Soledad Araya, profesora del curso, por los conocimientos\ntransmitidos y la apertura mostrada a los alumnos de intercambio.\nReferencias\nMiriam Ricci, 2015. Bike sharing: A review of evidence on impacts\nand processes of implementation and operation, Research in\nTransportation Business & Management, Volume 15, Pages 28-38, ISSN\n2210-5395, https://doi.org/10.1016/j.rtbm.2015.03.003.\nF. Gallego, JP. Montero, C.Salas, 2013. The effect of transport\npolicies on car use: Evidence from Latin American cities. Journal of\nPublic Economics 107 (2013) 47–62\n\n\n\n",
    "preview": "posts/2022-12-03-2022-12-01-proyecto-p4-modelo/2022-12-01-proyecto-p4-modelo_files/figure-html5/plot-hour-1.png",
    "last_modified": "2022-12-05T17:27:12-03:00",
    "input_file": "2022-12-01-proyecto-p4-modelo.knit.md"
  },
  {
    "path": "posts/2022-11-04-proyecto-p3-datos/",
    "title": "[Proyecto | Datos] Recopilación y Análisis de Datos",
    "description": "Esta publicación describe los datos y la forma en que fueron recopilados, seguido de un análisis gráfico de las variables de interés.",
    "author": [
      {
        "name": "Diogo Polónia",
        "url": "https://diogovalentepcs.github.io/website/"
      }
    ],
    "date": "2022-11-04",
    "categories": [],
    "contents": "\nPlanteamiento\nRecopilación de Datos\nComo se discutió en las publicaciones anteriores, trataremos con 3\ntipos de datos:\nDatos de series temporales de concentraciones de CO (variable\ndependiente) y SO2;\nDatos de series de tiempo de las condiciones climáticas (velocidad\ndel viento, dirección del viento, humedad relativa y temperatura);\nDatos de ubicación tanto de las estaciones de monitoreo como de las\nestaciones de Bike Itaú.\nTodos estos datos fueron recolectados manualmente. Del Sistema de\nInformación Nacional de la Calidad del Aire (SINCA), disponible en https://sinca.mma.gob.cl/index.php/region/index/id/M,\nfue posible recopilar todos los datos sobre la estaciones de monitoreo\n(todos los datos de series de tiempo). Esta información se recopiló en\narchivos .csv individuales de 9 de 14 estaciones, ya que solo estas 9\ntenían datos para el período de tiempo previsto (2018 - 2020), lo que\nnos deja un total de 49 archivos, 1 archivo por estación de monitoreo (9\n) por variable (6), a excepción de los datos de SO2, que solo estaban\ndisponibles para el período de tiempo previsto en 4 estaciones (\\(9 \\cdot 5 + 4 = 49\\)). Estos archivos están\ndisponibles en _assets/Data en el repositorio\nde GitHub de este proyecto.\nEn cuanto a los datos de ubicación, se creó un archivo de Excel\nindependiente con 2 hojas, la primera con los nombres y ubicaciones (en\ntipo UTM) de las estaciones de monitoreo (recolectadas de SINCA), y la\nsegunda hoja con los ID’s, capacidad y coordenadas (latitud y longitud)\nde cada estación de bicicletas compartidas en Santiago (todas\npertenecientes a Bike Itaú). Para esta última información se utilizó\nGoogle Maps, lo que me permitió recopilar información de 118\nestaciones.\nPreparación de los Datos\nLa preparación de los datos requiere los siguientes pasos:\nFiltrado de los conjuntos de datos para el período comprendido entre\nel 02-01-2018 y el 02-01-2020 (exactamente un año antes y después de la\nrenovación del sistema de Bike Itaú);\nFusionar todos los conjuntos de datos en uno solo, con diferentes\nvalores de indicador en diferentes columnas;\nValidar las conclusiones de artículos anteriores sobre los mejores\nplazos para analizar la concentración de CO (por ejemplo, las dos horas\nconsecutivas que en promedio marcan las lecturas más altas de CO en la\nmuestra de dos años);\nFiltre el conjunto de datos para esas horas (7 a. m. a 9 a.\nm.);\nAgregue valores para la contaminación de fondo antes de que se forme\nel pico y considere el promedio de 4 registros de CO consecutivos que,\nen promedio, mostraron la menor dispersión en el transcurso de la\nmuestra (1 a. m. a 5 a. m.)\nConstruir las variables ficticias que identifican las observaciones\nposteriores a la implementación, así como el indicador del mes;\nPupular con variables para día de la semana, hora del día y mes del\naño (dummies)\nSobre los datos de ubicación, se requiere: 1. Uniformizar los tipos\nde datos de ubicación; 2. Calcule las distancias lineales entre cada\nestación de monitoreo y todas las estaciones de bicicletas, y sume\ndichas distancias\nCriación de los\nwide_datas principales\nPrimero cargamos las pacakges necesarias:\n\n\nlibrary(stringr)  # adding variable sto a string\nlibrary(dplyr)    # manipulate dataframes\nlibrary(tidyr)    # tidying data\nlibrary(naniar)   # missing data visualizations\nlibrary(ggplot2)  # graphs\nlibrary(VIM)      # kNN inputation\n\n\nVejamos los datos para una estación de monitoreo (Puento Alto, por\nejemplo):\n\n\nemissions <- c( 'SO2', 'CO')\nweather <- c('WindSpeed', 'Temp', 'Hum')\nfor (item in c(weather, emissions)) {\n  data <- read.csv(str_glue('{params$datapath}_raw/{item}_PuenteAlto.csv'), header = TRUE, sep = ';')\n  show(data[1:5,])\n}\n\n  FECHA..YYMMDD. HORA..HHMM. X X.1\n1          90124         100    NA\n2          90124         200    NA\n3          90124         300    NA\n4          90124         400    NA\n5          90124         500    NA\n  FECHA..YYMMDD. HORA..HHMM. X X.1\n1          90124         100    NA\n2          90124         200    NA\n3          90124         300    NA\n4          90124         400    NA\n5          90124         500    NA\n  FECHA..YYMMDD. HORA..HHMM. X X.1\n1          40101         100    NA\n2          40101         200    NA\n3          40101         300    NA\n4          40101         400    NA\n5          40101         500    NA\n  FECHA..YYMMDD. HORA..HHMM. Registros.validados\n1          90125         100                   1\n2          90125         200                   1\n3          90125         300                   1\n4          90125         400                   1\n5          90125         500                   1\n  Registros.preliminares Registros.no.validados  X\n1                                               NA\n2                                               NA\n3                                               NA\n4                                               NA\n5                                               NA\n  FECHA..YYMMDD. HORA..HHMM. Registros.validados\n1          90125         100                 2,8\n2          90125         200                 2,7\n3          90125         300                 2,9\n4          90125         400                 2,6\n5          90125         500                 2,5\n  Registros.preliminares Registros.no.validados  X\n1                                               NA\n2                                               NA\n3                                               NA\n4                                               NA\n5                                               NA\n\nEnenntemos limpiar la CO y filtrar para las fechas que queremos (de\n2018-01-02 hasta 2020-01-02), 1 ãno antes y 1 año después de la\nimplementación.\n\n\n# Rename, drop colunms and change string to numeric\ndata <- read.csv(str_glue('{params$datapath}_raw/CO_PuenteAlto.csv'), header = TRUE, sep = ';')\ndata <- data %>%\n  rename(\"DateYYMMDD\" = \"FECHA..YYMMDD.\", \n         \"TimeHHMM\" = \"HORA..HHMM.\",\n         \"CO\" = \"Registros.validados\") %>%\n  select(-Registros.preliminares, -Registros.no.validados, -X) %>%\n  mutate(CO = as.numeric(gsub(\",\", \".\", CO)))\n\n# Drops unwanted years (before 01 Feb 18 and on or after 01 Feb 2020)\ndata <- data[data$DateYYMMDD >= params$start_date & data$DateYYMMDD < params$end_date, ]\n\n# Veryfy if all days and all hours exist \nif (length(data$DateYYMMDD) == as.numeric(difftime('2020-01-02', '2018-01-02', units = \"days\")) * 24) {\n  cat(\"All observations exist! :)\")\n} else {\n  cat(\"Missing observations... Look out! :(\")\n}\n\nAll observations exist! :)\n\nshow(data[1:10,])\n\n      DateYYMMDD TimeHHMM   CO\n79056     180201        0 0.14\n79057     180201      100 0.17\n79058     180201      200 0.20\n79059     180201      300 0.24\n79060     180201      400 0.19\n79061     180201      500 0.34\n79062     180201      600 0.58\n79063     180201      700 0.55\n79064     180201      800 0.41\n79065     180201      900 0.47\n\nAhora creamos el wide_data principal en forma “wide”, o sea con los\nvalores para cada estación como columnas, para todos los indicadores.\nEste formato permite: 1. Facilitar el analisis visual de los datos por\ncada estación, en especial en relación a los valores en falta; 2. No\nagregar NA’s para casos en que no hay estaciones de monitoreo para un\ndeterminado indicador (e.g el SO2 so fue monitorizado en 4\nestaciones)\n\n\n# Search for .csv files\nfiles <- list.files(path=str_glue('{params$datapath}_raw/'), pattern=\"*.csv\", full.names=TRUE, recursive=FALSE)\n\nwide_data <- data %>%\n  select(-CO)\n\n# Iterate each file name\nbad_dfs <- list()\ncounter <- 0\n\nfor (file in files) {\n    \n  file_pattern <- sub(str_glue('{params$datapath}_raw//'), '', file)\n  file_pattern <- sub('_.*', '', file_pattern)\n  \n  # Extract station name\n  station <- sub(str_glue(\".*{file_pattern}_\"), \"\", file)\n  station <- sub(\".csv.*\", \"\", station)\n  col_name <- as.character(str_glue(\"{file_pattern}_{station}\"))\n  \n  # Create dataframe\n  df <- read.csv(file, header = TRUE, sep = ';')\n  \n  # Clean dataframe\n  \n  if (file_pattern %in% emissions ) {\n      df <- df %>%\n             mutate(Registros.validados := as.numeric(gsub(\",\", \".\", Registros.validados))) %>%\n             rename(\"DateYYMMDD\" = \"FECHA..YYMMDD.\", \n               \"TimeHHMM\" = \"HORA..HHMM.\",\n                !!col_name := \"Registros.validados\") %>%\n             select(-Registros.preliminares, -Registros.no.validados, -X) \n  } else { \n     df <- df %>%\n       mutate(X := as.numeric(gsub(\",\", \".\", X))) %>%\n       rename(\"DateYYMMDD\" = \"FECHA..YYMMDD.\", \n         \"TimeHHMM\" = \"HORA..HHMM.\",\n          !!col_name := \"X\") %>%\n       select(-X.1) \n  }\n  \n  # Drops unwanted years (before 01 Feb 18 and on or after 01 Feb 2020)\n  df <- df[df$DateYYMMDD >= params$start_date & df$DateYYMMDD < params$end_date, ]\n\n  # Veryfy if all days and all hours exist \n  if (length(df$DateYYMMDD) != as.numeric(difftime('2020-01-02', '2018-01-02', units = \"days\")) * 24) {\n    bad_dfs[counter] <- station\n  }\n  \n  # Merge df with orginal data\n  wide_data <- merge(wide_data, df, by = c('DateYYMMDD', 'TimeHHMM'), all = TRUE)\n}\n\nif (counter > 0) {\n  cat(\"Some observations don't exist ... Lookout for the following wide_datas:\", bad_dfs)\n} else {\n  cat(\"All observations exist! :)\")\n}\n\nAll observations exist! :)\n\n# Create Index\ncols = colnames(wide_data)\nwide_data$index <- 1:nrow(wide_data)\n# Reorganize columns\nwide_data <- wide_data[, c('index', cols )]\nshow(wide_data[1:10,1:10])\n\n   index DateYYMMDD TimeHHMM CO_CerroNavia CO_ElBosque\n1      1     180201        0          0.21        0.38\n2      2     180201      100          0.22        0.26\n3      3     180201     1000          0.25        0.33\n4      4     180201     1100          0.27        0.28\n5      5     180201     1200          0.53        0.28\n6      6     180201     1300          0.51        0.26\n7      7     180201     1400          0.55        0.23\n8      8     180201     1500          0.54        0.19\n9      9     180201     1600          0.54        0.24\n10    10     180201     1700          0.57        0.25\n   CO_Independencia CO_LaFlorida CO_LasCondes CO_OHiggins CO_Paduhuel\n1              0.10         0.13         0.30        0.28        0.25\n2              0.11           NA         0.27        0.30          NA\n3              0.13           NA         0.51        0.30          NA\n4              0.13           NA         0.50        0.25          NA\n5              0.10           NA         0.37        0.18          NA\n6              0.10           NA         0.34        0.19          NA\n7              0.10           NA         0.30        0.15          NA\n8              0.10           NA         0.27        0.16          NA\n9              0.10           NA         0.27        0.11          NA\n10             0.10           NA         0.31        0.11          NA\n\nEDA (Exploratory Data\nAnalysis)\nMissing Data\n\nCO\n\n\nvis_miss(wide_data %>% select(starts_with('CO')))\n\n\n\n\nSO2\n\n\nvis_miss(wide_data %>% select(starts_with('SO2')))\n\n\n\n\nHum\n\n\nvis_miss(wide_data %>% select(starts_with('Hum')))\n\n\n\n\nWindSpeed\n\n\nvis_miss(wide_data %>% select(starts_with('WindSpeed')))\n\n\n\n\nTemp\n\n\nvis_miss(wide_data %>% select(starts_with('Temp')))\n\n\n\nLas estaciones de monitoreo de La Florida y Paduhel no tienen datos\nsuficientes para el analisis (en CO), por lo tanto se eliminará estas\nestaciones. Para las seguientes, se van usar estrategias de inputación\nde datos.\n\n\nwide_data <- wide_data %>% select(-ends_with('LaFlorida'))\nwide_data <- wide_data %>% select(-ends_with('Paduhuel'))\n\n\nDatos en formato “long”, el formato que se usará para la estimación\nde impacto. Este formato también facilita lo comparación entre\nindicadores y su relación con los dias y horas. Este formato no vá tener\nel SO2 porque este indicador no tiene todos las estaciones, y haciendo\nel pivot se agregarián valores NA a los demás que ya existen.\n\n\n# Pivoting to Long table\n\nlong_data <- wide_data %>% \n  select(-contains(\"SO2\")) %>%\n  tidyr::pivot_longer(\n   cols = contains(\"_\"), \n   names_to = c(\".value\", \"Station\"), \n   names_sep = \"_\")\n\nlong_data$index <- 1:nrow(long_data)\nshow(long_data[1:10,])\n\n# A tibble: 10 × 8\n   index DateYYMMDD TimeHHMM Station          CO   Hum  Temp WindSpeed\n   <int>      <int>    <int> <chr>         <dbl> <dbl> <dbl>     <dbl>\n 1     1     180201        0 CerroNavia     0.21  43.8  18.6    NA    \n 2     2     180201        0 ElBosque       0.38  52.0  18.7    NA    \n 3     3     180201        0 Independencia  0.1   40.2  22.1     0.334\n 4     4     180201        0 LasCondes      0.3   51.6  19.2    NA    \n 5     5     180201        0 OHiggins       0.28  48.1  18.9     0.134\n 6     6     180201        0 PuenteAlto     0.14  49.8  18.8     0.898\n 7     7     180201        0 Talagante      0.1   71.2  12.9     0.182\n 8     8     180201        0 Pudahuel      NA     44.5  21.8     0.828\n 9     9     180201      100 CerroNavia     0.22  45.9  17.5    NA    \n10    10     180201      100 ElBosque       0.26  52.0  18.2    NA    \n\nsummary(long_data)\n\n     index          DateYYMMDD        TimeHHMM      Station         \n Min.   :     1   Min.   :180201   Min.   :   0   Length:140160     \n 1st Qu.: 35041   1st Qu.:180802   1st Qu.: 575   Class :character  \n Median : 70080   Median :190166   Median :1150   Mode  :character  \n Mean   : 70080   Mean   :186518   Mean   :1150                     \n 3rd Qu.:105120   3rd Qu.:190802   3rd Qu.:1725                     \n Max.   :140160   Max.   :200131   Max.   :2300                     \n                                                                    \n       CO             Hum               Temp          WindSpeed    \n Min.   :0.10    Min.   :  2.167   Min.   :-3.317   Min.   :0.002  \n 1st Qu.:0.24    1st Qu.: 39.427   1st Qu.:10.100   1st Qu.:0.392  \n Median :0.41    Median : 57.500   Median :14.650   Median :0.802  \n Mean   :0.62    Mean   : 57.435   Mean   :15.482   Mean   :1.095  \n 3rd Qu.:0.72    3rd Qu.: 75.501   3rd Qu.:20.450   3rd Qu.:1.537  \n Max.   :9.75    Max.   :100.167   Max.   :39.100   Max.   :8.711  \n NA's   :34509   NA's   :1837      NA's   :3015     NA's   :15429  \n\n\n\nwrite.csv(wide_data,str_glue(\"{params$datapath}wide_data.csv\"), row.names = FALSE)\nwrite.csv(long_data,str_glue(\"{params$datapath}long_data.csv\"), row.names = FALSE)\ntest <- read.csv(str_glue('{params$datapath}long_data.csv'), header = TRUE, sep = ',')\n\n\nDe acuerdo con los restantes datos, no parece haber una regla horaria\npara los valores en falta (e.g. entre las 2h y 3h lo monitoreo desliga).\nLo que si acontece es que hay períodos longos en que no hay datos para\nuna determinada estacíon (y solo para un o dos indicadores), por ejemplo\npara la estación de El Bosque solo tiene 1.32% de datos sobre la\ntemperatura en falta, pero tiene 14.82% de datos del CO en falta. Esto\nse puede confirmar analisando el long_data por hora y se la\ndistribuicion de missing data es uniforme por las horas, se valida\nesto.\n\n\nmissing_data <- long_data %>% \n  group_by(TimeHHMM) %>%\n  dplyr::summarize(CO = sum(is.na(CO)), \n                   Hum = sum(is.na(Hum)), \n                   WindSpeed = sum(is.na(WindSpeed)), \n                   Temp = sum(is.na(Temp)))\n \nshow(missing_data)\n\n# A tibble: 24 × 5\n   TimeHHMM    CO   Hum WindSpeed  Temp\n      <int> <int> <int>     <int> <int>\n 1        0  1416    71       649   124\n 2      100  1614    74       648   125\n 3      200  1412    76       642   124\n 4      300  1421    83       643   126\n 5      400  1427    82       649   121\n 6      500  1415    87       642   121\n 7      600  1414    91       647   121\n 8      700  1413    92       639   120\n 9      800  1413    92       639   122\n10      900  1420    82       639   123\n# … with 14 more rows\n\nAsí que también hace sentido remover observaciones y se optará por\nestudiar las relaciones entre los indicadores y altura del dia/ año para\nestimar los valores en falta. Para esto vamos a trabajar con lo formato\nlongo, para estudiar las relaciones agregadamente\nEs necesario dividir la data en dia, mes y año.\n\n\nlong_data$index <- 1:nrow(long_data)\nlong_data <- long_data %>%\n  extract(DateYYMMDD, c(\"Year\",\"Month\", \"Day\"), \"(..)(..)(..)\", convert=TRUE, remove = FALSE) %>%\n  rename(\"Hour\" = \"TimeHHMM\") %>% # let's take this chance to rename the column \n  mutate(Hour = Hour/100) # There's only hourly verifiaction\n\nshow(long_data[1:10,])\n\n# A tibble: 10 × 11\n   index DateYYMMDD  Year Month   Day  Hour Station     CO   Hum  Temp\n   <int>      <int> <int> <int> <int> <dbl> <chr>    <dbl> <dbl> <dbl>\n 1     1     180201    18     2     1     0 CerroNa…  0.21  43.8  18.6\n 2     2     180201    18     2     1     0 ElBosque  0.38  52.0  18.7\n 3     3     180201    18     2     1     0 Indepen…  0.1   40.2  22.1\n 4     4     180201    18     2     1     0 LasCond…  0.3   51.6  19.2\n 5     5     180201    18     2     1     0 OHiggins  0.28  48.1  18.9\n 6     6     180201    18     2     1     0 PuenteA…  0.14  49.8  18.8\n 7     7     180201    18     2     1     0 Talagan…  0.1   71.2  12.9\n 8     8     180201    18     2     1     0 Pudahuel NA     44.5  21.8\n 9     9     180201    18     2     1     1 CerroNa…  0.22  45.9  17.5\n10    10     180201    18     2     1     1 ElBosque  0.26  52.0  18.2\n# … with 1 more variable: WindSpeed <dbl>\n\nVisualización Inicial\n\n\nplot_hour <- long_data %>% \n  group_by(Year, Month, Day, Hour)            %>%\n  summarise(CO = mean(CO, na.rm = TRUE))\nplot_hour$index = seq(-nrow(plot_hour)/2,nrow(plot_hour)/2 -1, by=1)\n\nplot_day <- long_data %>% \n  drop_na(CO)   %>%\n  group_by(Year, Month, Day)            %>%\n  summarise(CO = mean(CO))\nplot_day$index = seq(-nrow(plot_hour)/2, nrow(plot_hour)/2 -1, by = round(nrow(plot_hour)/nrow(plot_day)))\n\nplot_month <- long_data %>% \n  drop_na(CO)   %>%\n  group_by(Year, Month)            %>%\n  summarise(CO = mean(CO))\nplot_month$index = seq(-nrow(plot_hour)/2, nrow(plot_hour)/2 -1, by = round(nrow(plot_hour)/nrow(plot_month)))\n\nggplot() + \n  geom_point(data = plot_hour, aes( x = index , y = CO, color=\"Hourly Concentration\"), size=2, shape=23) + \n  geom_line(data = plot_day, aes( x = index , y = CO, color=\"Daily Average\"), size=1, alpha=0.5) + \n  geom_line(data = plot_month, aes( x = index , y = CO, color=\"Montlhy Average\"), size=1, alpha=0.5) +\n  geom_vline(xintercept = 0, linetype = \"dotted\", color = \"sienna\", size=1) +\n  annotate(\"text\", x=0 - 400, y=2.5, label=\"Implementación de Política\", angle=90, size=3.5) + \n  scale_color_manual(name = \"Values\", \n                     breaks=c(\"Hourly Concentration\", \"Daily Average\", \"Montlhy Average\"),\n                     values = c(\"Hourly Concentration\" = \"lightblue\", \"Daily Average\" = \"aquamarine\", \"Montlhy Average\" = \"firebrick\")) +\n  labs(x = \"Time since Implementation (hours)\", y = \"CO Concentration\",\n       title = \"Evolución de la concentración CO\")\n\n\n\nRelaciones entre variables\nAnalisis CO\n\nCO vs. Hum\n\n\nggplot(long_data, aes(x=CO, y=Hum)) +\n  geom_point(color=\"lightblue\", size=2, shape=23) + \n  labs(x = \"CO\", y = \"Hum\",\n       title = \"Relacion entre CO y Hum\")\n\n\n\n\nCO vs. Temp\n\n\nggplot(long_data, aes(x=CO, y=Temp)) +\n  geom_point(color=\"lightblue\", size=2, shape=23) + \n  labs(x = \"CO\", y = \"Temp\",\n       title = \"Relacion entre CO y Temp\")\n\n\n\n\nCO vs. WindSpeed\n\n\nggplot(long_data, aes(x=CO, y=WindSpeed)) +\n  geom_point(color=\"lightblue\", size=2, shape=23) + \n  labs(x = \"CO\", y = \"WindSpeed\",\n       title = \"Relacion entre CO y WindSpeed\")\n\n\n\n\nCO vs. Station\n\n\nggplot(long_data, aes(x=Station, y=CO, color=Station)) + \n    geom_boxplot()+ \n  labs(x = \"Station\", y = \"CO\",\n       title = \"Relacion entre CO y Station\")\n\n\n\n\nCO vs. Month\n\n\nggplot(long_data, aes(x=as.factor(Month), y=CO, color=as.factor(Month))) + \n  geom_boxplot() + \n  labs(x = \"Month\", y = \"CO\",\n       title = \"Relacion entre CO y Month\")\n\n\n\n\nCO vs. Day\n\n\nggplot(long_data, aes(x=as.factor(Day), y=CO, color=as.factor(Day))) + \n  geom_boxplot() + \n  labs(x = \"Day\", y = \"CO\",\n       title = \"Relacion entre CO y Day\")\n\n\n\n\nCO vs. Hour\n\n\nggplot(long_data, aes(x=as.factor(Hour), y=CO, color=as.factor(Hour))) + \n    geom_boxplot() + \n  labs(x = \"Hour\", y = \"CO\",\n       title = \"Relacion entre Hour y CO\")\n\n\n\nAnalisis Humidad\n\nHum vs. Temp\n\n\nggplot(long_data, aes(x=Hum, y=Temp)) +\n  geom_point(color=\"lightblue\", size=2, shape=23) + \n  labs(x = \"Hum\", y = \"Temp\",\n       title = \"Relacion entre Hum y Temp\")\n\n\n\n\nHum vs. WindSpeed\n\n\nggplot(long_data, aes(x=Hum, y=WindSpeed)) +\n  geom_point(color=\"lightblue\", size=2, shape=23) + \n  labs(x = \"Hum\", y = \"WindSpeed\",\n       title = \"Relacion entre Hum y WindSpeed\")\n\n\n\n\nHum vs. Station\n\n\nggplot(long_data, aes(x=Station, y=Hum, color=Station)) + \n    geom_boxplot()  + \n    labs(x = \"Station\", y = \"Hum\",\n       title = \"Relacion entre Hum y Station\")\n\n\n\n\nHum vs. Month\n\n\nggplot(long_data, aes(x=as.factor(Month), y=Hum, color=as.factor(Month))) + \n    geom_boxplot() + \n    labs(x = \"Month\", y = \"Hum\",\n       title = \"Relacion entre Hum y Month\")\n\n\n\n\nHum vs. Day\n\n\nggplot(long_data, aes(x=as.factor(Day), y=Hum, color=as.factor(Day))) + \n    geom_boxplot() + \n  labs(x = \"Day\", y = \"Hum\",\n       title = \"Relacion entre Day y Hum\")\n\n\n\n\nHum vs. Hour\n\n\nggplot(long_data, aes(x=as.factor(Hour), y=Hum, color=as.factor(Hour))) + \n    geom_boxplot() + \n  labs(x = \"Hour\", y = \"Hum\",\n       title = \"Relacion entre Hour y Hum\")\n\n\n\nAnalisis Temperatura\n\nTemp vs. WindSpeed\n\n\nggplot(long_data, aes(x=Temp, y=WindSpeed)) +\n  geom_point(color=\"lightblue\", size=2, shape=23) + \n  labs(x = \"Temp\", y = \"WindSpeed\",\n       title = \"Relacion entre Temp y WindSpeed\")\n\n\n\n\nTemp vs. Station\n\n\nggplot(long_data, aes(x=Station, y=Temp, color=Station)) + \n    geom_boxplot() + \n  labs(x = \"Station\", y = \"Temp\",\n       title = \"Relacion entre Temp y Station\")\n\n\n\n\nTemp vs. Month\n\n\nggplot(long_data, aes(x=as.factor(Month), y=Temp, color=as.factor(Month))) + \n  geom_boxplot() + \n  labs(x = \"Month\", y = \"Temp\",\n       title = \"Relacion entre Temp y Month\")\n\n\n\n\nTemp vs. Day\n\n\nggplot(long_data, aes(x=as.factor(Day), y=Temp, color=as.factor(Day))) + \n    geom_boxplot() + \n  labs(x = \"Day\", y = \"Temp\",\n       title = \"Relacion entre Day y Temp\")\n\n\n\n\nTemp vs. Hour\n\n\nggplot(long_data, aes(x=as.factor(Hour), y=Temp, color=as.factor(Hour))) + \n    geom_boxplot() + \n  labs(x = \"Hour\", y = \"Temp\",\n       title = \"Relacion entre Hour y Temp\")\n\n\n\nAnalisis Velocidad Viento\n\nWindSpeed vs. Station\n\n\nggplot(long_data, aes(x=Station, y=WindSpeed, color=Station)) + \n    geom_boxplot()  +\n  labs(x = \"Station\", y = \"WindSpeed\",\n       title = \"Relacion entre Station y WindSpeed\")\n\n\n\n\nWindSpeed vs. Month\n\n\nggplot(long_data, aes(x=as.factor(Month), y=WindSpeed, color=as.factor(Month))) + \n  geom_boxplot() + \n  labs(x = \"Month\", y = \"WindSpeed\",\n       title = \"Relacion entre WindSpeed y Month\")\n\n\n\n\nWindSpeed vs. Day\n\n\nggplot(long_data, aes(x=as.factor(Day), y=WindSpeed, color=as.factor(Day))) + \n    geom_boxplot() + \n  labs(x = \"Day\", y = \"WindSpeed\",\n       title = \"Relacion entre Day y WindSpeed\")\n\n\n\n\nWindSpeed vs. Hour\n\n\nggplot(long_data, aes(x=as.factor(Hour), y=WindSpeed, color=as.factor(Hour))) + \n    geom_boxplot() + \n  labs(x = \"Hour\", y = \"WindSpeed\",\n       title = \"Relacion entre Hour y WindSpeed\")\n\n\n\nCon estes graficos nos apercebemos que hay relaciones fuertes entre\nalgunas de las variables registradas por la estación de monitoreo.\nAdemás, los valores registados dependen mucho del mes del año y de la\nhora del dia, y varian un poco entre las estaciónes de monitoreo. Por la\npresencia de relaciones fuertes entre las variables, se procederá a la\ninputación de datos.\nInputación de Datos\nSe procederá a la inputación de datos de base en KNN o regression\n\n\n#Nearest Neighbor - Treat missing values\n\n##apply o nearest neighbor (kk), with k=5 because it's a default value\n##numerical variables with missing values\nclean_wide_data <- wide_data[, -1]\nclean_wide_data<-kNN(clean_wide_data, variable=colnames(clean_wide_data[,2:36]), k=5)\nsum(is.na(clean_wide_data))\n\n[1] 0\n\n\n\nclean_wide_data<-clean_wide_data[,1:36]\n\nclean_long_data <- clean_wide_data %>% \n  select(-contains(\"SO2\")) %>%\n  tidyr::pivot_longer(\n   cols = contains(\"_\"), \n   names_to = c(\".value\", \"Station\"), \n   names_sep = \"_\") %>%\n  extract(DateYYMMDD, c(\"Year\",\"Month\", \"Day\"), \"(..)(..)(..)\", convert=TRUE, remove = FALSE) %>%\n  rename(\"Hour\" = \"TimeHHMM\") %>% # let's take this chance to rename the column \n  mutate(Hour = Hour/100) # There's only hourly verifiaction\n\nclean_long_data[1:10,]\n\n# A tibble: 10 × 10\n   DateYYM…¹  Year Month   Day  Hour Station    CO   Hum  Temp WindS…²\n       <int> <int> <int> <int> <dbl> <chr>   <dbl> <dbl> <dbl>   <dbl>\n 1    180201    18     2     1     0 CerroN…  0.21  43.8  18.6   0.463\n 2    180201    18     2     1     0 ElBosq…  0.38  52.0  18.7   0.544\n 3    180201    18     2     1     0 Indepe…  0.1   40.2  22.1   0.334\n 4    180201    18     2     1     0 LasCon…  0.3   51.6  19.2   1.93 \n 5    180201    18     2     1     0 OHiggi…  0.28  48.1  18.9   0.134\n 6    180201    18     2     1     0 Puente…  0.14  49.8  18.8   0.898\n 7    180201    18     2     1     0 Talaga…  0.1   71.2  12.9   0.182\n 8    180201    18     2     1     0 Pudahu… NA     44.5  21.8   0.828\n 9    180201    18     2     1     1 CerroN…  0.22  45.9  17.5   0.447\n10    180201    18     2     1     1 ElBosq…  0.26  52.0  18.2   0.557\n# … with abbreviated variable names ¹​DateYYMMDD, ²​WindSpeed\n\n\n\nwrite.csv(clean_wide_data,str_glue(\"{params$datapath}clean_wide_data.csv\"), row.names = FALSE)\nwrite.csv(clean_long_data,str_glue(\"{params$datapath}clean_long_data.csv\"), row.names = FALSE)\n\n\nSe puede verificar si la inputacion fue buena comparando un nuevo\ngrafico de CO por ejemplo:\n\n\nplot_hour <- clean_long_data %>% \n  group_by(Year, Month, Day, Hour)            %>%\n  summarise(CO = mean(CO, na.rm = TRUE))\nplot_hour$index = seq(-nrow(plot_hour)/2,nrow(plot_hour)/2 -1, by=1)\n\nplot_day <- clean_long_data %>% \n  drop_na(CO)   %>%\n  group_by(Year, Month, Day)            %>%\n  summarise(CO = mean(CO))\nplot_day$index = seq(-nrow(plot_hour)/2, nrow(plot_hour)/2 -1, by = round(nrow(plot_hour)/nrow(plot_day)))\n\nplot_month <- clean_long_data %>% \n  drop_na(CO)   %>%\n  group_by(Year, Month)            %>%\n  summarise(CO = mean(CO))\nplot_month$index = seq(-nrow(plot_hour)/2, nrow(plot_hour)/2 -1, by = round(nrow(plot_hour)/nrow(plot_month)))\n\nggplot() + \n  geom_point(data = plot_hour, aes( x = index , y = CO, color=\"Hourly Concentration\"), size=2, shape=23) + \n  geom_line(data = plot_day, aes( x = index , y = CO, color=\"Daily Average\"), size=1, alpha=0.5) + \n  geom_line(data = plot_month, aes( x = index , y = CO, color=\"Montlhy Average\"), size=1, alpha=0.5) +\n  geom_vline(xintercept = 0, linetype = \"dotted\", color = \"sienna\", size=1) +\n  annotate(\"text\", x=0 - 400, y=2.5, label=\"Implementación de Política\", angle=90, size=3.5) + \n  scale_color_manual(name = \"Values\", \n                     breaks=c(\"Hourly Concentration\", \"Daily Average\", \"Montlhy Average\"),\n                     values = c(\"Hourly Concentration\" = \"lightblue\", \"Daily Average\" = \"aquamarine\", \"Montlhy Average\" = \"firebrick\")) +\n  labs(x = \"Time since Implementation (hours)\", y = \"CO Concentration\",\n       title = \"Evolución de la concentración CO\")\n\n\n\n\n\n\n",
    "preview": "posts/2022-11-04-proyecto-p3-datos/proyecto-p3-datos_files/figure-html5/visualize-missing-data-1-1.png",
    "last_modified": "2022-12-03T12:19:43-03:00",
    "input_file": "proyecto-p3-datos.knit.md"
  },
  {
    "path": "posts/2022-11-04-proyecto-p2-planteamiento-terico/",
    "title": "[Proyecto | Planteamiento Teórico] Estrategia Empírica y Planteamiento Teórico del Modelo",
    "description": "En este post se hace la descripción de la estrategia empírica base de mi proyecto de Medícion y Analsisis de Datos Políticos, explicando las variables y lo modelo de regresión lineal que va utilizarse.",
    "author": [
      {
        "name": "Diogo Polónia",
        "url": "https://diogovalentepcs.github.io/website/"
      }
    ],
    "date": "2022-11-03",
    "categories": [],
    "contents": "\nInferencia\nCausal y Presupuestos Econometricos\nUno de los mayores retos en los debates políticos es la falta de\ncomprensión clara de la inferencia contrafactual y causal. Cuando\nqueremos conocer el efecto causal de una intervención (cambio de\npolítica, tratamiento médico, implantación de un sistema de bicicletas\ncompartidas) sobre un resultado determinado, es necesario comparar dos\nestados del mundo: el mundo en el que se produjo la intervención y el\nmundo en el que no se produjo. Este último es el mundo contrafactual. El\nproblema es que no es posible observar el mundo en dos estados a la vez,\nlo que significa que observar el contrafactual es complicado y está\nsujeto a falacias racionales.\nLa mayoría de las veces, inferimos la causalidad a partir de una\nsimple comparación entre el mundo posterior a la intervención y el mundo\nanterior. Se trata de un análisis pre-post (en el que el “pre” sirve de\ncontrafactual, un sustituto de cómo sería el mundo en ausencia de la\nintervención). Sin embargo, no se trata de un verdadero contrafactual,\nporque siempre hay muchos factores externos que pueden influir en los\nresultados que buscamos, lo que significa que estaríamos atribuyendo\nerróneamente a una política efectos que podrían ser causados por algo\ntotalmente distinto.\nEn lugar de ello, deberíamos basarnos en un conjunto de técnicas\neconométricas para crear un contrafactual fiable, con métodos\nexperimentales (asignación aleatoria), cuasi experimentales o no\nexperimentales (por ejemplo, regresión discontinua, emparejamiento).\nSin embargo, hay situaciones en las que es muy difícil llevar a cabo\nestos diseños. Este es uno de esos casos:\nNo hay pruebas de que las estaciones hayan sido asignadas\naleatoriamente, y hay fuertes razones para creer que Bike Itaú las\ncolocó estratégicamente;\nNo hay una barrera clara que impida el uso del servicio (o que lo\npromueva), lo que hace que diseños como el de Discontinuidad de\nRegresión\nLos datos disponibles son escasos, demasiado aproximados y no lo\nsuficientemente granulares como para permitir el uso de Variables\nInstrumentales o Matching (por ejemplo, no hay datos sobre los\nindividuos que utilizan las bicicletas o los vehículos)\nPor lo tanto, tendremos que recurrir al método menos que ideal del\nanálisis pre-post (1 año antes y 1 año después, de modo a no introducir\nlo impacto de la pandemia de Covid-19), pero adoptaremos algunas\nestrategias para poder inferir la causalidad de dicho proceso. Éstas\nserán:\nControlar la estimación por variables observables que influyan\ndirectamente en la concentración de CO en el aire (velocidad y dirección\ndel viento, temperatura, humedad), o que puedan captar otros efectos\nfijos (concentración de otros contaminantes);\nRealizar una prueba de placebo, estimando el impacto de la\nimplantación del sistema, sobre un punto en el tiempo anterior a la\nmisma, donde no debería haber impacto. La falta de estimaciones de\nimpacto significativas sobre el placebo validará aún más el modelo;\n(Para futuros trabajos) Siguiendo a Gallego et al. 2013, existe una\npequeña población con una estación de monitorización que presenta una\ntendencia de CO ex-ante que la hace indistinguible, en términos\nrelativos, de las tendencias de CO de cualquiera de las estaciones de\nmonitorización de Santiago. Esta ciudad puede servir como contrafactual\nde una estimación de impacto de diferencias en diferencias.\nPor quê CO?\nEl monóxido de carbono (CO) es un candidato natural para estudiar los\ncambios en el uso del automóvil es una serie temporal con lecturas\nhorarias del tráfico de vehículos procedentes de estaciones de control\nde tráfico. El uso de recuentos de tráfico reales es inviable,\nprincipalmente debido a:\nNo existe información horaria de fácil acceso sobre el tráfico;\nPuede haber efectos de equilibrio general y de desplazamiento en los\nque, por ejemplo, las intervenciones locales temporales o el aumento de\nla congestión en un lugar concreto (calle) obligan a los conductores a\nbuscar calles alternativas (por ejemplo, una estación en una calle\natascada informaría de un flujo de tráfico prácticamente nulo). Como las\nestaciones de recuento sólo cubren una pequeña fracción de las calles,\nes imposible registrar todos estos flujos de “desvío”. Por lo tanto,\nestos registros de tráfico pueden subestimar en gran medida el uso del\ncoche;\nLa congestión también puede disminuir los recuentos de tráfico por\nhora, ya que los coches se mueven más lentamente, lo que aumenta la\nfalta de fiabilidad de su estimación del uso del coche.\nA pesar de que no mide el uso del coche directamente, sino un\nsubproducto del mismo, nuestro sustituto preferido para el uso del coche\nes el CO en las horas punta. Dada la complejidad de la dinámica del\ntransporte en grandes ciudades como Santiago, el uso de registros de\nconcentración de CO por hora parece alentador por varias razones:\nSegún los inventarios de emisiones, las fuentes móviles, y los\nvehículos ligeros en particular, son con diferencia los principales\nemisores de CO, 97% y 94%, respectivamente;\nLas mediciones de CO, al contrario que los registros horarios del\ntráfico de vehículos, captan mejor los efectos a escala de la ciudad o\nel municipio que en un lugar concreto (por ejemplo, una calle);\nDado que las emisiones de CO están inversamente relacionadas con la\nvelocidad de los vehículos para un amplio rango (Robertson et al.,\n1998), los niveles de CO crecen monotónicamente con el tráfico (es\ndecir, el número de viajes en coche) independientemente del nivel\ninicial de congestión;\nEl uso del CO es que los registros de concentración en el pico de la\nmañana, digamos a las 8-9 am, están directamente relacionados con la\nactividad del tráfico en ese momento del día, porque la razón es que el\nCO es el único contaminante que puede considerarse no reactivo (es\ndecir, que no reacciona con otros contaminantes o con la luz solar) en\nuna escala de tiempo de un día, que es tiempo más que suficiente para\nque un contaminante se disperse (Schmitz, 2005);\nEn condiciones meteorológicas estables, antes y alrededor de la hora\npunta de la mañana, el rápido aumento del uso de los vehículos (y de las\nemisiones de CO) se refleja inmediatamente en cambios en los niveles de\ncontaminación por CO, que sólo se dispersan cuando el viento se levanta\nmás tarde por la mañana (Jorquera, 2002);\nLos registros de CO en las horas pico es que es probable que las\nlecturas de las estaciones de monitoreo individuales capturen los\ndesplazamientos de los hogares cercanos (más tarde en el día y a medida\nque se desarrollan los vientos, los registros de concentración en una\nestación en particular se “contaminan” con emisiones de lugares\ndistantes;\nLos dos últimos puntos presentan motivos para creer que una segunda\nestación también registra una pequeña parte del CO registrado por una\nestación de monitoreo.\nEspecificaciones\nEconométricas y Modelo de Regresión\nLa variable dependiente es dada por los registros de CO durante las\nhoras pico de los días de semana (se excluyen los sábados, domingos y\nfestivos). Las horas pico se definen como las dos horas consecutivas que\nen promedio marcan las lecturas más altas en los dos años de la muestra\n(de 7:00 a 9:00 am). Es posible emplear enfoques de estimación que se\nbasen en un fit flexible que incluya una variable ficticia de\ntratamiento para todo el período ex post de la póliza y una serie de\nvariables ficticias mensuales que capturen la fase de ajuste posterior a\nla implementación. Las ecuaciones de estimación bajo los dos enfoques\nestán dadas por la sieguinte regresión:\n\\[ y_{ts} = α_0 + α_1 \\cdot y_t^b + α_2\n\\cdot x_t + β_1 \\cdot T_t  +β_2 \\cdot T_t \\cdot d_s + \\sum δ_t \\cdot M_t\n+ ε_t \\] donde \\(y_t\\) es la\nconcentración de CO en el período (hora) t y en la estación\nmeteorologica s, en logs. Las variables explicativas son las\nsiguientes:\n\\(y_t^b\\) es la contaminación de\nfondo antes de que se forme el pico, que corresponde a la contaminación\nnocturna (consideramos el promedio de 4 registros consecutivos de CO\nque, en promedio, mostraron la menor dispersión a lo largo de la\nmuestra: 3–7 am;\n\\(x_t\\) es un vector que incluye\nefectos fijos (hora del día, día de la semana y mes del año), medidas\nhorarias de variables meteorológicas como temperatura, humedad real,\nvelocidad y dirección del viento. También incluimos registros de SO2\ncomo variable explicativa, los cuales están fácilmente disponibles en\nlas mismas estaciones de monitoreo.\nDado que el SO2 está principalmente relacionado con la actividad\nindustrial y la generación de energía, sirve como un control de\nfenómenos meteorológicos comunes a todos los contaminantes, pero que no\nson capturados en su totalidad por nuestras variables climáticas, como\nlas inversiones térmicas (Molina y Molina, 2002).\nEl efecto del sistema de Bike Itaú se captura con:\n\\(T_t\\), dummy que toma el valor de\n1 después de la implementación;\n\\(d_s\\), indica el promedio de las\ndistancias de la estación meteorologica s a las estaciones de bike\nitaú\n\\(M_t\\), un indicador de mes que\ncubre varios meses después de la implementación (hasta 12);\nEl efecto de la implementación de bicicletas compartidas sería \\(β + δ_1\\) a corto plazo (es decir, el\nprimer mes) y \\(β\\) a largo plazo.\nFinalmente, \\(ε_t\\) es el término de\nerror. Cada observación es una hora en que se detectó la concentración\nde CO.\nTambién es importante controlar la distancia de una estación de\nmonitoreo a las estaciones de bicicletas (y su capacidad). Sin embargo,\nesto requerirá un mayor análisis, ya que la mejor manera de incluir esta\ninformación no es obvia. Aquí hay algunas ideas sobre cómo hacerlo: 1.\nEjecute diferentes estimaciones para cada estación de monitoreo\nindividualmente. El efecto calculado debe aumentar inversamente con la\nsuma de las distancias de la estación de monitoreo a las estaciones de\nBike Itaú. Esta relación también podría sufrir una regresión; 2. Dividir\nlas observaciones por estación de monitoreo e incluir como variable\nexplicativa la suma de distancias, identificando cada estación.\nReferencias\nF. Gallego, JP. Montero, C.Salas, 2013. The effect of transport\npolicies on car use: Evidence from Latin American cities. Journal of\nPublic Economics 107 (2013) 47–62\nS. Robertson, H. Ward, G. Marsden, U. Sandberg, U. Hammerstrom,\n1998. The effects of speed on noise, vibration and emissions from\nvehicles. University College London\nSchmitz, R., 2005. Modelling of air pollution dispersion in Santiago\nde Chile. Atmos. Environ. 39, 2035–2047\nJorquera, H., 2002. Air quality at Santiago, Chile: a box-modeling\napproach—I. Carbon monoxide, nitrogen oxides and sulfur dioxide. Atmos.\nEnviron. 36, 315–330\nMolina, L., Molina, M. (Eds.), 2002. Air Quality in the Mexico\nMegacity: An Integrated Assessment. Kluwer Academic Publishers,\nDordrecht\n\n\n\n",
    "preview": {},
    "last_modified": "2022-12-05T17:26:31-03:00",
    "input_file": "proyecto-p2-planteamiento-terico.knit.md"
  },
  {
    "path": "posts/2022-09-08-entrega-1-introduccion-teorica-del-proyecto/",
    "title": "[Proyecto | Introducción y Revisión Literaria] El Impacto de la Micromobilidad en lo Uso de Auto en Santiago",
    "description": "En este post planteo teoricamente el trabajo del proyecto de Medícion y Analsisis de Datos Políticos. Esta descripción incluye un análisis del tema de interés, inluindo una revisón de literatura, las variables disponibles y la hipótesis a testar, como base de mi investigación en el curso.",
    "author": [
      {
        "name": "Diogo Polónia",
        "url": "https://diogovalentepcs.github.io/website/"
      }
    ],
    "date": "2022-11-02",
    "categories": [],
    "contents": "\nIntroducción\nEl sector del transporte es una de las mayores fuentes de emisiones\nde CO2eq y una fuente importante de contaminación atmosférica. Dentro\ndel transporte general los “Passenger Road Vehicles”, es dicir los\nvehículos de transporte de pasajeros en carretera son los que más\ncontaminan, incluso en comparación con “Road Freight Vehicles”,\n“Aviation” and “Shipping” (International Energy Agency, 2021).\nTransport sector CO2eq emissions by mode\nuntill 2018 and in the Sustainable Development Scenario (SDS) after\n2018La contaminación del aire y la congéstion de los vehículo sieguen\nsiendo problemas sérios en muchas ciudades por todo el mundo, pero\nparticularmente en economias emergentes devido a lo aumento constante de\nlo uso de autos (Gallego et al., 2013). En muchas situaciónes, esto\npuede convertirse en una de las principales causas de “Smog” y\ncontaminación del aire.\nEl smog se forma al mezclar el aire con contaminantes y gases de\nescape resultantes de las actividades humanas. Entre los factores\nresponsables se encuentran las fábricas, el creciente número de coches,\nla quema de carbón, madera y otros combustibles sólidos en las estufas.\nSu formación también viene determinada por el tiempo, el clima y las\ncondiciones generales de la zona. Será mucho más difícil deshacerse de\nlos contaminantes cuando una ciudad esté en un valle y el clima sin\nviento impida que se dispersen y se diluyan, haciendo que queden\nsuspendidos sobre la ciudad. (Airly 2020)\nSantiago, en particular, está anidada entre dos cordilleras, la de\nlos Andes y la de la Costa, lo que crea una bolsa de aire viciado en el\nvalle con una ventilación mínima, provocando un fuerte smog y\ncontaminación, inducida por la cantidad de pequeñas partículas\nrespirables, PM2,5, en el aire (COHA, 2015).\nEn el contexto del enfoque de ciudad inteligente, la integración de\nlas innovaciones tecnológicas en los sistemas de movilidad urbana, por\nejemplo con la micromovilidad compartida, presentan una grand\noportunidad para mejorar el medio ambiente y la calidad de vida.\nCiudades en la America Latina ya experimentaran con diferents incentivos\na la utilización de meios alternativos al auto y muchas empresas en esto\nsecto han crescido mucho. En Febrero de 2019, por ejemplo, la\nMunicipalidad de Santiago, con la compania Bike Itaú, lanzó un nuevo\nsistema de bicicletas compartidas para los residentes y visitantes de la\nciudad, con planes mensuales de menos de 4 000 pesos, con el fin de\npromover el uso de esta solución de micromovilidad y, en consecuencia,\nmejorar el medio ambiente.\nDada la complejidad de la dinamica del transporte en una grand\nciudad, internciones como esta presentan oportunidades unicas para\nprofundizar nuestro conocimiento sobre como la populación (en general y\nhogares con difrentes niveles de ingresso) responde a politicas de\nmicromovilidad. Este proyecto es un intento empirico de evaluar estas\nrespostas, si y cuán rápido los hogares disminuen el uso del auto\nHipótesis y\nContextualiación Literaria\nNo es la primera vez que se estudia si la implementación de\nsoluciones de micromovilidad compartida de facil acesso en ciudades\nurbanas son efectivas en persuadir conductores a dejar el auto y cambiar\npara estas soluciónes, ni si “bycicle sharing” tiene un impacto real en\nlo ambiente. De hecho, ya hay conocimiento sobre lo “ahorro” ambiental\nen varios indicadores que la micromovilidad compartida orgina, a traves\nde una “Life Cycle Assessment (LCA)” (e.g. Zheng et al., 2019 y\nD’Almeida et al., 2021). En Shanghai, la implementación de bicicletas\ncompartidas evitó la emissión de 25 000 toneladas de CO2 y 65 toneladas\nde NOX en 2016 (Zhang et al., 2018). La disminuicion del tráfico y\ncongestión (y, tamníen de la poluición sonora) promovida por\nalternativas al uso del auto también ha sio examinada un poco por todo\nel mundo (Caulfield et al., 2017; Martens, 2007; Mont, 2004).\nSin embargo, mismo con un concensus largo sobre los varios beneficios\nambientales que soluciones de bicicletas compartidas, pocos son los\nestudios que estimen, directamente, los impactos de “bike sharing” en el\nuso de auto en grandes ciudades (y la consecuente impacto en la\npoluición atmosférica), con técnicas de inferencia causal pertinentes.\nEs innegable que el uso compartido de la bicicleta, como icono de los\nsistemas de economía compartida y de servicio de productos, está ganando\nuna creciente popularidad a nivel mundial, pero hay poco conocimiento\nsobre las condiciones en las que se está utilizando este modo de viaje\nemergente y si realmente están contribuyendo a una reducción del uso del\nauto. Este proyecto pretende, así, contribuir para cubrir este vacío de\ninvestigación a través de técnicas econometricas para estimar\ncuantitativamente los impactos del uso compartido de bicicletas en el\nuso de autos en Santiago. Es de esperar que también ayude a cuantificar\nmejor los efectos de las políticas de micromovilidad entre los grupos de\ningresos y el tiempo. Se plantea, entonces, la sieguinte pregunta:\nHa\ntenido efecto la renovación de lo sistema de bicicletas compartidas\nbaratas y accessibles en a lo uso de auto en Santiago?\nSiguiendo el trabajo de Gallego et al., 2013, que estudia el impacto\nde las políticas de restricción del uso del auto, a falta de una medida\ndirecta del uso del coche, esta evaluación empírica se basará en un\nsubproducto del uso del coche: las observaciones horarias de la\nconcentración de monóxido de carbono (CO), que son registradas por una\nred de estaciones de control distribuidas por la ciudad (las estaciones\ntambién llevan registros de otros contaminantes y variables\nmeteorológicas). El CO es un buen indicador del uso de los vehículos,\nsobre todo en las horas punta (de la mañana), en comparación con otros\ncandidatos como los registros horarios de los flujos de tráfico y de\notros contaminantes. Las fuentes móviles, y los vehículos ligeros en\nparticular, son con mucho los principales emisores de CO, el 97% y el\n94%, respectivamente.\nLa estrategia empírica consistirá en comparar los registros de CO en\nlas horas punta un año antes y después de la aplicación de lo sistema,\ncontrolando al mismo tiempo los efectos fijos del día de la semana y del\nmes del año, así como las condiciones meteorológicas (y, posteriormente,\nla actividad económica). Esta estrategia maneja bien la volatilidad\ndiaria de los datos, que es habitual en las series temporales de\ncontaminación, porque no estimamos el impacto de la política en un día\nconcreto (por ejemplo, justo después de la aplicación de la política),\nsino a lo largo de un periodo de varios meses.\nPor lo tanto, hay que entender cómo se caracteriza el uso de auto en\nlas horas de punta matinales (7 - 9), a traves de la contaminación del\naire (CO) en Santiago, así como la ubicación de las estaciónes de\nbicicletas y todas las variables que pueden confundir el impacto del\nsistema en las mediciónes de CO.\nVariables Operacionales\nConcentración horaria de CO y otros poluentes (SO2)\nUbicación de las estáciones de control del aire\nUbicación y número de bicicletas disponibles en cada estación de\nBike Itaú\nTemperatura, humidad, velocidad y dirección del viento por hora\n(Futuramente) Census socio-economicos de la populación de\nSantiago\nPara esto se recorrerá a las seguintes bases de datos:\nSistema de\nInformación Nacional de la Calidad del Aire (SINCA)\nGoogle\nMaps\nInstituto\nNacional de Estadisticas\nHipotesis\nMi hipotesis es la siguiente: La utilización de bicicletas\ncompartidas tien una relácion débil con la diminuición del uso de\nauto\nArgumentos:\nLa gente utiliza estos vehículos sobre todo para los desplazamientos\nque, de otro modo, habrían realizado a pie, en bicicleta (no eléctrica)\no en transporte público (no sustituye a los autos).\nReferencias\nIneternational\nEnergy Agency, 2021; Transport\nAirly,\n2020; What is Smog\nCOHA, 2015; The\nBattle to Breathe: Chile’s Toxic Threat\nF. Gallego, JP. Montero, C.Salas, 2013. The effect of transport\npolicies on car use: Evidence from Latin American cities. Journal of\nPublic Economics 107 (2013) 47–62\nF. Zheng,F.Gu, W.Zhang, J.Guo, 2019. Is Bicycle Sharing an\nEnvironmental Practice? Evidence from a Life Cycle Assessment Based on\nBehavioral Surveys. MPDI Sustainability Journal\nY. Zhang, Z. Mi, 2018.Environmental benefits of bike sharing: A big\ndata-based analysis. Applied Energy 220 (2018) 296-301\nL. D’Almeida, T. Rye, F Pomponid, 2021. Emissions assessment of bike\nsharing schemes: The case of Just Eat Cycles in Edinburgh, UK.\nSustainable Cities and Society 71 (2021)\nB. Caulfield, O’Mahony, M., Brazil, W., Weldon, P., 2017. Examining\nusage patterns of a bike-sharing scheme in a medium sized city. Transp.\nRes. Part A Policy Pract. 100, 152–161. doi:10.1016/j.tra.2017.04.023\nK. Martens, 2007. Promoting bike-and-ride: The Dutch experience.\nTransp. Res. Part A Policy Pract. 41, 326–338\nO. Mont, 2004. Institutionalisation of sustainable consumption\npatterns based on shared use. Ecol. Econ. 50, 135–153. doi:10.1016/J.ECOLECON.2004.03.030\n\n\n\n",
    "preview": {},
    "last_modified": "2022-12-05T17:25:58-03:00",
    "input_file": "entrega-1-introduccion-teorica-del-proyecto.knit.md"
  },
  {
    "path": "posts/2022-09-08-entrega-1-discursos-politicos-y-conciencia-ambiental/",
    "title": "[Proyecto | Introducción] Discursos Politicos y Conciencia Ambiental (Discontinued)",
    "description": "En este post describo una des mis opciones para el trabajo teórico del proyecto de Medícion y Analsisis de Datos Políticos. Esta descripción incluye un análisis del tema de interes y las variables disponibles como base de mi investigación el curso.",
    "author": [
      {
        "name": "Diogo Polónia",
        "url": "https://diogovalentepcs.github.io/website/"
      }
    ],
    "date": "2022-09-08",
    "categories": [],
    "contents": "\nIntroducción\nA pesar de los grandes avances tecnológicos, políticos y de\ncomportamiento que se han producido en el mundo en los últimos años para\nenfrentar el cambio climático, es difícil exagerar el reto que el cambio\nclimático supone para la política, lo que unido a la dificultad de\nconseguir reducciones significativas de las emisiones, plantea\nimplicaciones de gran calado en la forma de hacer política.\nSon los propios políticos quienes, a través de las instituciones a\nnivel mundial, nacional y local, tienen la tarea de mediar en las\nrespuestas a los complejos problemas relacionados con el clima. Sin\nembargo, es difícil encontrar un análisis sistemático del impacto de los\ndiscursos de los políticos de alto nivel sobre el cambio climático,\nespecialmente en el comportamiento de la población en general con\nrespecto al medio ambiente. Esto plantea la pregunta politica:\nHa\ntenido efecto los discursos politicos relacionados con el clima en\ncambiar efectivamente los comportamientos generales de los\nciudadanos?\nChile es particularmente vulnerable al cambio climático y ya está\nexperimentando impactos del cambio climático. Entre otros efectos, Chile\nlleva acusando una sequía prolongada en el centro y sur del país desde\nel año 2010 (CR2, 2019).\nLos gases de efecto invernadero, como por ejemplo el CO2, son los que\nmás contribuyen al cambio climático mundial, y Chile hile es el país\nnúmero 140 del ranking de países por emisiones de CO2. En la figura se\npuede ver la evolución del CO2 per capita en lo país (Datosmacro,\n2019).\nChile: Per capita: how much CO2 does the\naverage person emit?En los últimos años, Chile ha introducido muchas políticas para\nluchar contra el cambio climático. Pero, ¿cómo entienden y articulan los\npolíticos chilenos un tema tan complejo como el cambio climático? ¿Y qué\neficacia tienen a la hora de inducir un cambio real en el comportamiento\nde los ciudadanos y la concienciación medioambiental?\nPara responder a estas preguntas, propongo analizar los discursos\npolíticos relacionados con el medio ambiente en Chile, utilizando el\nanálisis de sentimientos NLP y el análisis de corpus, para entender cómo\nse relacionan con el cambio de comportamiento real de los consumidores\nen las acciones medioambientales (por ejemplo, el reciclaje, el\ntransporte, los patrones de compra, etc.).\nVariables Operacionales\nEmissiones CO2eq\nSantiago AQI index\nNiveles PM2.5\nTasas de reciclaje\nDistancias percorridas en auto, bus y avión\nTipo de discurso politico\nEntidad discursora\nPara esto se puede recorrer a las seguintes bases de datos: * Instituto\nNacional de Estadisticas * Registro\nde Emisiones y Transferencias de Contaminantes (RETC) * World Bank Data para\nChile * Emisiones\nde Chile segun el Banco Mundial Chile\nHipotesis\nMi hipotesis es la siguiente: Los discursos políticos sobre\nel medio ambiente no consiguen inducir un cambio de comportamiento en la\npoblación.\nReferencias\nCR2, 2019; La megasequía\n2010-2019: Una lección para el futuro\nDatosmacro,\n2019; CO2 Chile\nOur World in\nData, 2019; CO2 Emissions\n\n\n\n",
    "preview": {},
    "last_modified": "2022-11-04T14:38:54-03:00",
    "input_file": {}
  },
  {
    "path": "posts/2022-09-01-tarea/",
    "title": "Tarea Clase 01 Septiembre",
    "description": "Graficos",
    "author": [
      {
        "name": "Diogo Polónia",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2022-09-01",
    "categories": [],
    "contents": "\nTarea\nUna de las formas de aprender a usar R, es simplemente aprender a\nbuscar lo que necesitamos usar. Algunos de las funciones las hemos visto\nen clases, pero siempre pueden buscar otras formas de lograr los mismos\nresultados.\nCon los materiales que hemos visto, vamos a realizar gráficos\nexploratorios:\nLibraries:\n\n\nlibrary(dplyr)\nlibrary(ggplot2)\n\n\nCarga de bases de datos:\n\n\nvdem <- readRDS(\"../../_clases/vdem.rds\")\n\nvdem_subset <- vdem %>% \n  select(country_name, v2x_partipdem, \n         v2x_cspart, v2elmulpar, v2psprlnks, e_peedgini, \n         e_regionpol, e_gdppc, e_pop) %>% \n  group_by(country_name) %>% \n  summarise_all(function(x)  mean(x, na.rm = T))\n\n\nHistograma\n\n\nvdem_subset %>% \n  ggplot(aes(x = v2x_cspart, na.rm = T)) +\n  geom_histogram(binwidth = 0.05) +\n  theme_minimal(base_family = \"Arial\") +\n  labs(x = \"Participación de las personas en OSC [0-1] \", y = \"Frecuencia\",\n       title = \"Distribución de la variable dependiente\",\n       caption = \"Fuente: Varieties of Democracy\")\n\n\n\nGráfico de barras\n\n\nvdem_subset %>% \n  ggplot(aes(x=factor(e_regionpol)))+\n  geom_bar( color=\"cadetblue\", fill=\"steelblue\", alpha = 0.5) +\n  theme_minimal() +\n  labs(x = \"Clasificacion Politica\", y = \"Frecuencia\",\n       title = \"Paises por Clasificacion Politica\",\n       caption = \"Fuente: Varieties of Democracy\")\n\n\n\nBoxplot\n\n\nvdem_subset %>% \n  ggplot(aes(x=factor(e_regionpol), y = e_peedgini  ))+\n  geom_boxplot( color=\"cadetblue\", fill=\"steelblue\", alpha = 0.5) +\n  theme_minimal() +\n  labs(x = \"Clasificacion Politica\", y = \"Inequidad Educacional\",\n       title = \"Distribuicion de Inequidad Educacional por Clasificacion Politica\",\n       caption = \"Fuente: Varieties of Democracy\")\n\n\n\nScatterplot\n\n\nvdem_subset %>% \n  ggplot(aes(x = e_peedgini, y = v2x_cspart)) +\n  geom_point() +\n  labs(x = \"Coeficiente de Gini de desiguadad educaciona\", y = \"Participación\") +\n  theme_minimal(base_family = \"Arial\") +\n  theme(axis.text = element_text(size = 16),\n        axis.title = element_text(size = 18))\n\n\n\n\n\n\n",
    "preview": "posts/2022-09-01-tarea/Tarea-Clase-01_09_files/figure-html5/unnamed-chunk-3-1.png",
    "last_modified": "2022-09-01T21:17:44-04:00",
    "input_file": {}
  },
  {
    "path": "posts/welcome/",
    "title": "Welcome to Blog Datos Politicos",
    "description": "Welcome to our new blog, Blog Datos Politicos. We hope you enjoy \nreading what we have to say!",
    "author": [
      {
        "name": "Nora Jones",
        "url": "https://example.com/norajones"
      }
    ],
    "date": "2022-08-25",
    "categories": [],
    "contents": "\n\n\n\n",
    "preview": {},
    "last_modified": "2022-08-25T14:32:43-04:00",
    "input_file": {}
  }
]
